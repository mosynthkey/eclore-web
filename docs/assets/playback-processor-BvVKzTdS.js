var h=Object.defineProperty;var u=(i,t,s)=>t in i?h(i,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):i[t]=s;var e=(i,t,s)=>u(i,typeof t!="symbol"?t+"":t,s);class c extends AudioWorkletProcessor{constructor(){super();e(this,"buffer",null);e(this,"position",0);e(this,"isPlaying",!1);this.port.onmessage=s=>{s.data.type==="loadBuffer"?this.buffer=s.data.buffer:s.data.type==="play"?(this.isPlaying=!0,this.position=s.data.position||0):s.data.type==="pause"?this.isPlaying=!1:s.data.type==="seek"&&(this.position=Math.trunc(Math.floor(s.data.position)||0))}}process(s,n){if(!this.buffer||!this.isPlaying)return!0;const r=n[0],f=this.buffer[0].length;for(let o=0;o<r.length;o++){const p=r[o],l=this.buffer[o];for(let a=0;a<p.length;a++)this.position>=f&&(this.position=0,this.port.postMessage({type:"loop"})),p[a]=l[this.position],this.position++,this.position%128===0&&this.port.postMessage({type:"position",position:this.position,sampleRate})}return!0}}registerProcessor("playback-processor",c);
